# Linux

## 基础

- linux中，一切皆文件
- 根目录/，所有文件都挂载在这个目录下

### 对目录的解释

| 目录            |                                                              |
| --------------- | ------------------------------------------------------------ |
| **/bin**        | 存放二进制可执行文件(ls,cat,mkdir等)，常用命令一般都在这里。 |
| **/etc**        | 存放系统管理和配置文件                                       |
| **/home**       | 存放所有用户文件的根目录，是用户主目录的基点，比如用户user的主目录就是/home/user，可以用~user表示 |
| **/usr**        | 用于存放系统应用程序，比较重要的目录<br />/usr/local 本地系统<br />管理员软件安装目录（安装系统级的应用）。<br />这是最庞大的目录，要用到的应用程序和文件几乎都在这个目录。<br />/usr/x11r6 存放x window的目录<br />/usr/bin 众多的应用程序<br />/usr/sbin 超级用户的一些管理程序<br />/usr/doc linux文档<br />/usr/include linux下开发和编译应用程序所需要的头文件<br />/usr/lib 常用的动态链接库和软件包的配置文件<br />/usr/man 帮助文档<br />/usr/src 源代码，linux内核的源代码就放在/usr/src/linux里<br />/usr/local/bin 本地增加的命令<br />/usr/local/lib 本地增加的库 |
| **/opt**        | 额外安装的可选应用程序包所放置的位置。一般情况下，我们可以把tomcat等都安装到这里。 |
| **/proc**       | 虚拟文件系统目录，是系统内存的映射。可直接访问这个目录来获取系统信息。 |
| **/root**       | 超级用户（系统管理员）的主目录（特权阶级^o^）                |
| **/sbin**       | 存放二进制可执行文件，只有root才能访问。这里存放的是系统管理员使用的系统级别的管理命令和程序。如ifconfig等。 |
| **/dev**        | 用于存放设备文件。                                           |
| **/mnt**        | 系统管理员安装临时文件系统的安装点，系统提供这个目录是让用户临时挂载其他的文件系统。 |
| **/boot**       | 存放用于系统引导时使用的各种文件                             |
| **/lib**        | 存放跟文件系统中的程序运行所需要的共享库及内核模块。<br />共享库又叫动态链接共享库，作用类似windows里的.dll文件，存放了根文件系统程序运行所需的共享文件。 |
| **/var**        | 用于存放运行时需要改变数据的文件，也是某些大文件的溢出区，比方说各种服务的日志文件（系统启动日志等。）等。 |
| **/tmp**        | 用于存放各种临时文件，是公用的临时文件存储点。               |
| **/lost+found** | 这个目录平时是空的，系统非正常关机而留下“无家可归”的文件（windows下叫什么.chk）就在这里 |
| **/www**        | 存放服务器网站相关的资源，环境，网站的项目                   |

## 基本命令

### shutdown：关机

```shell
sync # 将数据由内存同步到硬盘
shutdown # 关机 man shutdown 获取帮助
	-h 10 # 10分钟后关机
	-h now # 立马关机
	-h 20:25 # 20:25时关机
	-h +10 # 十分钟后关机
	-r now # 立马重启
	-r +10 # 十分钟后重启
reboot # 重启
halt # 关闭系统。==shutdown -h now == poweroff
```

不管重启还是关闭系统，首先运行**sync**命令，把内存数据写入硬盘

### cd：切换目录

```shell
cd 目录路径（绝对路径:/开头;相对路径）
	./ # 当前目录
	.. # 上一级目录
	~ # 切换到当前用户目录
```

### ls：列出目录

```shell
ls
	-a # all,查看全部文件，包括隐藏
	-l # 列出所有文件，包括文件的属性和权限，不包括隐藏文件
```

### pwd：显示当前所在目录

### mkdir：创建目录

```shell
mkdir 目录路径
	-p # 递归创建目录
```

### rmdir：移除目录

```shell
rmdir 目录路径 # 只能删除空目录
	-p # 递归删除多个目录
```

### rm：移除文件或目录

```shell
rm 目录路径或文件路径
	-f # 忽略不存在的文件，不会出现警告，强制删除
	-r # 递归删除目录
	-i # 删除的时候询问是否删除
	
rm  -rf / # 删除系统中所有文件
```

### cp：复制文件或者目录

```shell
cp 原文件路径 新路径
```

### mv：移动文件或目录（重命名文件）

```shell
mv 原文件或目录路径 新路径
	-f # 强制
	-u # 只替换已更新的文件
```

## 文件属性

- 当为 **d** 则是目录
- 当为 **-** 则是文件；
- 若是 **l** 则表示为链接文档(link file)；
- 若是 **b** 则表示为装置文件里面的可供储存的接口设备(可随机存取装置)；
- 若是 **c** 则表示为装置文件里面的串行端口设备，例如键盘、鼠标(一次性读取装置)。

接下来的字符中，以三个为一组，且均为 **rwx** 的三个参数的组合。其中， **r** 代表可读(read)、 **w** 代表可写(write)、 **x** 代表可执行(execute)。 要注意的是，这三个权限的位置不会改变，如果没有权限，就会出现减号 **-** 而已。

> 第0位确定文件类型，1-3位确定属主（该文件所有者）拥有该文件的权限，4-6位确定属组（所有者的同组用户）的权限，7-9位确定其他用户的权限

### touch：创建文件

### echo：向文件输入内容

```shell
echo "内容" >>文件
echo "内容" # 仅仅输出文字
```

### chgrp：更改文件属组

```shell
chgrp 属组名 文件名
	-R # 递归更改文件属组
```

### chown：更改文件属主，也可以同时更改文件属组：

```shell
chown [-R] 属主名 文件名
chown [-R] 属主名:属组名 文件名
```

### chmod：更改文件9个属性

```shell
chmod [-R] xyz 文件或目录 # chmod -R 777 filename
```

| r(可读) | w（可写） | x（可执行） |
| ------- | --------- | ----------- |
| 4       | 2         | 1           |

每种身份各自的三个权限（r/w/x）分数需要累加，例如当权限为：[-rwxr-x---]分数分别是

- owner = rwx = 4+2+1 = 7

- group = r-x = 4+1 =5
- others = --- = 0+0+0 = 0

## 文件内容查看

linux系统中使用以下命令来查看文件

- cat 由第一行开始显示文件内容

- tac 从最后一行开始显示

- nl 显示的时候，顺道输出行号

- more 一页一页显示文件内容 (空格代表翻页，enter代表向下一行 :f查看当前行号)

- less 与more类似，但可以往前翻页

  ```shell
  pageUp键 # 向上翻页
  pageDown键 # 向下翻页
  q # 退出
  /字符串 # 向下查找指定字符串
  	n 继续搜寻下一个
  	N 向上寻找
  ?字符串 # 向上查找指定字符串	
  ```

- head -n 只看头几行

- tail 只看尾巴几行

可以使用man **命令** 来查看各个命令的使用文档，如：man cat

## 链接

linux的链接分为两种：

- **硬链接** 相当于允许一个文件拥有多个路径，防止误删
- **软链接** 类似win的快捷方式

```shell
ln 源文件 链接文件 # 硬链接
	-s # 软链接 xshell 显示浅蓝色 变红源文件已删除
```

## Vim编辑器

所有linux内置vi编辑器，vim是从vi发展而来

vim 文件名 文件如果不存在，则新建

### 三种模式

- **命令模式** 刚启动vim，是命令模式
- **输入模式** **i** 切换到输入模式，esc退出编辑模式
- **底线模式** 命令模式 按 **:** 进入底线模式，可以输入底线命令

#### 底线模式

```shell
q # 退出
w # 保存
w! # 强制写入
```


| 指令行的储存、离开等指令                                     |                                                              |
| :----------------------------------------------------------- | :----------------------------------------------------------- |
| :w                                                           | 将编辑的数据写入硬盘档案中(常用)                             |
| :w!                                                          | 若文件属性为『只读』时，强制写入该档案。不过，到底能不能写入， 还是跟你对该档案的档案权限有关啊！ |
| :q                                                           | 离开 vi (常用)                                               |
| :q!                                                          | 若曾修改过档案，又不想储存，使用 ! 为强制离开不储存档案。    |
| 注意一下啊，那个惊叹号 (!) 在 vi 当中，常常具有『强制』的意思～ |                                                              |
| :wq                                                          | 储存后离开，若为 :wq! 则为强制储存后离开 (常用)              |
| ZZ                                                           | 这是大写的 Z 喔！若档案没有更动，则不储存离开，若档案已经被更动过，则储存后离开！ |
| :w [filename]                                                | 将编辑的数据储存成另一个档案（类似另存新档）                 |
| :r [filename]                                                | 在编辑的数据中，读入另一个档案的数据。亦即将 『filename』 这个档案内容加到游标所在行后面 |
| :n1,n2 w [filename]                                          | 将 n1 到 n2 的内容储存成 filename 这个档案。                 |
| :! command                                                   | 暂时离开 vi 到指令行模式下执行 command 的显示结果！例如 『:! ls /home』即可在 vi 当中看 /home 底下以 ls 输出的档案信息！ |
| :set nu                                                      | 显示行号，设定之后，会在每一行的前缀显示该行的行号           |
| :set nonu                                                    | 与 set nu 相反，为取消行号！                                 |

#### 命令模式

```shell
i # 切换到输入模式
: # 切换到底线模式
x # 删除当前光标所处的字符
```

| 进入输入或取代的编辑模式 |                                                              |
| :----------------------- | :----------------------------------------------------------- |
| i, I                     | 进入输入模式(Insert mode)：i 为『从目前光标所在处输入』， I 为『在目前所在行的第一个非空格符处开始输入』。(常用) |
| a, A                     | 进入输入模式(Insert mode)：a 为『从目前光标所在的下一个字符处开始输入』， A 为『从光标所在行的最后一个字符处开始输入』。(常用) |
| o, O                     | 进入输入模式(Insert mode)：这是英文字母 o 的大小写。o 为『在目前光标所在的下一行处输入新的一行』；O 为在目前光标所在处的上一行输入新的一行！(常用) |
| r, R                     | 进入取代模式(Replace mode)：r 只会取代光标所在的那一个字符一次；R会一直取代光标所在的文字，直到按下 ESC 为止；(常用) |
| [Esc]                    | 退出编辑模式，回到一般模式中(常用)                           |

| 移动光标的方法     |                                                              |
| :----------------- | :----------------------------------------------------------- |
| h 或 向左箭头键(←) | 光标向左移动一个字符                                         |
| j 或 向下箭头键(↓) | 光标向下移动一个字符                                         |
| k 或 向上箭头键(↑) | 光标向上移动一个字符                                         |
| l 或 向右箭头键(→) | 光标向右移动一个字符                                         |
| [Ctrl] + [f]       | 屏幕『向下』移动一页，相当于 [Page Down]按键 (常用)          |
| [Ctrl] + [b]       | 屏幕『向上』移动一页，相当于 [Page Up] 按键 (常用)           |
| [Ctrl] + [d]       | 屏幕『向下』移动半页                                         |
| [Ctrl] + [u]       | 屏幕『向上』移动半页                                         |
| +                  | 光标移动到非空格符的下一行                                   |
| -                  | 光标移动到非空格符的上一行                                   |
| n< space>          | 那个 n 表示『数字』，例如 20 。按下数字后再按空格键，光标会向右移动这一行的 n 个字符。 |
| 0 或功能键[Home]   | 这是数字『 0 』：移动到这一行的最前面字符处 (常用)           |
| $ 或功能键[End]    | 移动到这一行的最后面字符处(常用)                             |
| H                  | 光标移动到这个屏幕的最上方那一行的第一个字符                 |
| M                  | 光标移动到这个屏幕的中央那一行的第一个字符                   |
| L                  | 光标移动到这个屏幕的最下方那一行的第一个字符                 |
| G                  | 移动到这个档案的最后一行(常用)                               |
| nG                 | n 为数字。移动到这个档案的第 n 行。例如 20G 则会移动到这个档案的第 20 行(可配合 :set nu) |
| gg                 | 移动到这个档案的第一行，相当于 1G 啊！(常用)                 |
| n< Enter>          | n 为数字。光标向下移动 n 行(常用)                            |

| 搜索替换 |                                                              |
| :------- | :----------------------------------------------------------- |
| /word    | 向光标之下寻找一个名称为 word 的字符串。例如要在档案内搜寻 vbird 这个字符串，就输入 /vbird 即可！(常用) |
| ?word    | 向光标之上寻找一个字符串名称为 word 的字符串。               |
| n        | 这个 n 是英文按键。代表重复前一个搜寻的动作。举例来说， 如果刚刚我们执行 /vbird 去向下搜寻 vbird 这个字符串，则按下 n 后，会向下继续搜寻下一个名称为 vbird 的字符串。如果是执行 ?vbird 的话，那么按下 n 则会向上继续搜寻名称为 vbird 的字符串！ |
| N        | 这个 N 是英文按键。与 n 刚好相反，为『反向』进行前一个搜寻动作。例如 /vbird 后，按下 N 则表示『向上』搜寻 vbird 。 |

| 删除、复制与粘贴 |                                                              |
| :--------------- | :----------------------------------------------------------- |
| x, X             | 在一行字当中，x 为向后删除一个字符 (相当于 [del] 按键)， X 为向前删除一个字符(相当于 [backspace] 亦即是退格键) (常用) |
| nx               | n 为数字，连续向后删除 n 个字符。举例来说，我要连续删除 10 个字符， 『10x』。 |
| dd               | 删除游标所在的那一整行(常用)                                 |
| ndd              | n 为数字。删除光标所在的向下 n 行，例如 20dd 则是删除 20 行 (常用) |
| d1G              | 删除光标所在到第一行的所有数据                               |
| dG               | 删除光标所在到最后一行的所有数据                             |
| d$               | 删除游标所在处，到该行的最后一个字符                         |
| d0               | 那个是数字的 0 ，删除游标所在处，到该行的最前面一个字符      |
| yy               | 复制游标所在的那一行(常用)                                   |
| nyy              | n 为数字。复制光标所在的向下 n 行，例如 20yy 则是复制 20 行(常用) |
| y1G              | 复制游标所在行到第一行的所有数据                             |
| yG               | 复制游标所在行到最后一行的所有数据                           |
| y0               | 复制光标所在的那个字符到该行行首的所有数据                   |
| y$               | 复制光标所在的那个字符到该行行尾的所有数据                   |
| p, P             | p 为将已复制的数据在光标下一行贴上，P 则为贴在游标上一行！举例来说，我目前光标在第 20 行，且已经复制了 10 行数据。则按下 p 后， 那 10 行数据会贴在原本的 20 行之后，亦即由 21 行开始贴。但如果是按下 P 呢？那么原本的第 20 行会被推到变成 30 行。(常用) |
| J                | 将光标所在行与下一行的数据结合成同一行                       |
| c                | 重复删除多个数据，例如向下删除 10 行，[ 10cj ]               |
| u                | 复原前一个动作。(常用)                                       |
| [Ctrl]+r         | 重做上一个动作。(常用)                                       |

## 账号管理

用户文件：/etc/passwd

### useradd：添加用户

```shell
useradd 用户名 
	-m # 自动创建这个用户的主目录 /home/用户名
	-c # comment 指定一段注释性描述。
	-d # 目录 指定用户主目录，如果此目录不存在，则同时使用-m选项，可以创建主目录。
	-g # 用户组 指定用户所属的用户组。
	-G # 用户组，用户组 指定用户所属的附加组。
	-m　# 使用者目录如不存在则自动建立。
	-s # Shell文件 指定用户的登录Shell。
	-u # 用户号 指定用户的用户号，如果同时有-o选项，则可以重复使用其他用户的标识号。
```

### userdel：删除用户

```shell
userdel 用户名
	-r # 同时清空用户的目录页
```

### usermod：修改用户

```shell
usermod 用户名
	# 参数和添加一样
```

### su：切换用户

```shell
su 用户名
exit 退出当前用户
```

$ 表示普通用户，# 表示超级用户

### hostname：修改主机名

```shell
hostname # 查看主机名
	名称 # 修改
```

### passwd 修改密码

```shell
passwd 
	用户名 # root账号，可以修改其他用户
```

### 锁定用户

```shell
passwd -l 用户名
passwd u 用户名
```

## 用户组

用户组文件：/etc/group

### groupadd：添加用户组

```shell
groupadd 用户组名
groupadd -g 组id 组名 # 可以指定组id,如果不指定，会自增
```

### groupdel：删除用户组

```shell
groupdel 用户组名
```

### groupmod：修改用户组的权限和名字

```shell
groupmod -g 新id -n 新名字 用户组名
```

### 用户切换用户组

```shell
# 普通用户
newgrp 用户名
```

## 磁盘管理

```shell
df # 列出文件系统整体的磁盘使用量
	-h # 切换为字节单位
du # 列出当前目录下的文件磁盘使用量
	-sm /* # 检查根目录下每个目录的占用情况
```

## 进程管理

### ps：查看当前系统正在执行的各种进程信息

```shell
ps
	-a # 显示当前终端运行的进程信息
	-A # 显示当前终端运行的所有进程信息
	-u # 以用户的信息显示进程
	-x # 显示后台运行进程的参数
# |  在linux叫做管道符 A|B 将A的结果给B
# grep 查找文件中符合条件的字符串
ps -aux|grep java # 查找java

ps -ef # 可以查看到父进程的信息

pstree # 查看父京城信息
	-p # 显示父id
	-u # 显示用户组
```

### kill：结束进程

```shell
kill 进程id
	-9 # 强制结束
```



